{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///home/finvia/Documentos/GitHub/academiamx/auth.config.ts"],"sourcesContent":["import type { NextAuthConfig } from \"next-auth\"\n\nexport const authConfig = {\n  pages: {\n    signIn: \"/auth/login\",\n  },\n  callbacks: {\n    authorized({ auth, request: { nextUrl } }) {\n      const isLoggedIn = !!auth?.user\n      const isOnDashboard = nextUrl.pathname.startsWith(\"/dashboard\")\n      if (isOnDashboard) {\n        if (isLoggedIn) return true\n        return false // Redirect unauthenticated users to login page\n      } else if (isLoggedIn) {\n        // Redirect logged-in users away from auth pages\n        if (nextUrl.pathname.startsWith(\"/auth\")) {\n           return Response.redirect(new URL(\"/dashboard\", nextUrl))\n        }\n      }\n      return true\n    },\n  },\n  providers: [], // Add providers with an empty array for now\n} satisfies NextAuthConfig\n"],"names":[],"mappings":";;;;AAEO,MAAM,aAAa;IACxB,OAAO;QACL,QAAQ;IACV;IACA,WAAW;QACT,YAAW,EAAE,IAAI,EAAE,SAAS,EAAE,OAAO,EAAE,EAAE;YACvC,MAAM,aAAa,CAAC,CAAC,MAAM;YAC3B,MAAM,gBAAgB,QAAQ,QAAQ,CAAC,UAAU,CAAC;YAClD,IAAI,eAAe;gBACjB,IAAI,YAAY,OAAO;gBACvB,OAAO,MAAM,+CAA+C;;YAC9D,OAAO,IAAI,YAAY;gBACrB,gDAAgD;gBAChD,IAAI,QAAQ,QAAQ,CAAC,UAAU,CAAC,UAAU;oBACvC,OAAO,SAAS,QAAQ,CAAC,IAAI,IAAI,cAAc;gBAClD;YACF;YACA,OAAO;QACT;IACF;IACA,WAAW,EAAE;AACf"}},
    {"offset": {"line": 47, "column": 0}, "map": {"version":3,"sources":["file:///home/finvia/Documentos/GitHub/academiamx/auth.ts"],"sourcesContent":["import NextAuth from \"next-auth\"\nimport { authConfig } from \"./auth.config\"\nimport Credentials from \"next-auth/providers/credentials\"\nimport { z } from \"zod\"\nimport { PrismaClient } from \"@prisma/client\"\nimport bcrypt from \"bcryptjs\"\n\nconst prisma = new PrismaClient()\n\nasync function getUser(email: string) {\n    try {\n        const user = await prisma.user.findUnique({ where: { email } })\n        return user\n    } catch (error) {\n        console.error(\"Failed to fetch user:\", error)\n        throw new Error(\"Failed to fetch user.\")\n    }\n}\n\nexport const { auth, signIn, signOut, handlers } = NextAuth({\n    ...authConfig,\n    callbacks: {\n        async jwt({ token, user }) {\n            if (user) {\n                token.role = user.role\n            }\n            return token\n        },\n        async session({ session, token }) {\n            if (token && session.user) {\n                session.user.role = token.role as string\n            }\n            return session\n        },\n    },\n    providers: [\n        Credentials({\n            async authorize(credentials) {\n                const parsedCredentials = z\n                    .object({ email: z.string().email(), password: z.string().min(6) })\n                    .safeParse(credentials)\n\n                if (parsedCredentials.success) {\n                    const { email, password } = parsedCredentials.data\n                    const user = await getUser(email)\n                    if (!user) return null\n\n                    // Since password is optional in schema (for OAuth potentially), check if it exists\n                    if (!user.password) return null;\n\n                    const passwordsMatch = await bcrypt.compare(password, user.password)\n\n                    if (passwordsMatch) return user\n                }\n\n                console.log(\"Invalid credentials\")\n                return null\n            },\n        }),\n    ],\n})\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;;;;;;;AAEA,MAAM,SAAS,IAAI,6IAAY;AAE/B,eAAe,QAAQ,KAAa;IAChC,IAAI;QACA,MAAM,OAAO,MAAM,OAAO,IAAI,CAAC,UAAU,CAAC;YAAE,OAAO;gBAAE;YAAM;QAAE;QAC7D,OAAO;IACX,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,yBAAyB;QACvC,MAAM,IAAI,MAAM;IACpB;AACJ;AAEO,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,QAAQ,EAAE,GAAG,IAAA,sMAAQ,EAAC;IACxD,GAAG,kKAAU;IACb,WAAW;QACP,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE;YACrB,IAAI,MAAM;gBACN,MAAM,IAAI,GAAG,KAAK,IAAI;YAC1B;YACA,OAAO;QACX;QACA,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC5B,IAAI,SAAS,QAAQ,IAAI,EAAE;gBACvB,QAAQ,IAAI,CAAC,IAAI,GAAG,MAAM,IAAI;YAClC;YACA,OAAO;QACX;IACJ;IACA,WAAW;QACP,IAAA,2MAAW,EAAC;YACR,MAAM,WAAU,WAAW;gBACvB,MAAM,oBAAoB,6MAAC,CACtB,MAAM,CAAC;oBAAE,OAAO,6MAAC,CAAC,MAAM,GAAG,KAAK;oBAAI,UAAU,6MAAC,CAAC,MAAM,GAAG,GAAG,CAAC;gBAAG,GAChE,SAAS,CAAC;gBAEf,IAAI,kBAAkB,OAAO,EAAE;oBAC3B,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,kBAAkB,IAAI;oBAClD,MAAM,OAAO,MAAM,QAAQ;oBAC3B,IAAI,CAAC,MAAM,OAAO;oBAElB,mFAAmF;oBACnF,IAAI,CAAC,KAAK,QAAQ,EAAE,OAAO;oBAE3B,MAAM,iBAAiB,MAAM,kLAAM,CAAC,OAAO,CAAC,UAAU,KAAK,QAAQ;oBAEnE,IAAI,gBAAgB,OAAO;gBAC/B;gBAEA,QAAQ,GAAG,CAAC;gBACZ,OAAO;YACX;QACJ;KACH;AACL"}},
    {"offset": {"line": 126, "column": 0}, "map": {"version":3,"sources":["file:///home/finvia/Documentos/GitHub/academiamx/app/auth/login/actions.ts"],"sourcesContent":["\"use server\"\n\nimport { signIn } from \"@/auth\"\nimport { AuthError } from \"next-auth\"\n\nexport async function authenticate(\n    prevState: string | undefined,\n    formData: FormData,\n) {\n    try {\n        await signIn(\"credentials\", formData)\n    } catch (error) {\n        if (error instanceof AuthError) {\n            switch (error.type) {\n                case \"CredentialsSignin\":\n                    return \"Credenciales inválidas.\"\n                default:\n                    return \"Algo salió mal.\"\n            }\n        }\n        throw error\n    }\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;;;;;AAEO,eAAe,aAClB,SAA6B,EAC7B,QAAkB;IAElB,IAAI;QACA,MAAM,IAAA,oJAAM,EAAC,eAAe;IAChC,EAAE,OAAO,OAAO;QACZ,IAAI,iBAAiB,2LAAS,EAAE;YAC5B,OAAQ,MAAM,IAAI;gBACd,KAAK;oBACD,OAAO;gBACX;oBACI,OAAO;YACf;QACJ;QACA,MAAM;IACV;AACJ;;;IAjBsB;;AAAA,qRAAA"}},
    {"offset": {"line": 162, "column": 0}, "map": {"version":3,"sources":["file:///home/finvia/Documentos/GitHub/academiamx/.next-internal/server/app/auth/login/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {authenticate as '60484701ccfb5239a99afb97062c52c13b5ddbf431'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA"}}]
}