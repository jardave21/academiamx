{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/finvia/Documentos/GitHub/academiamx/app/auth/signup/actions.ts"],"sourcesContent":["\"use server\"\n\nimport { z } from \"zod\"\nimport { prisma } from \"@/lib/prisma\"\nimport bcrypt from \"bcryptjs\"\nimport { redirect } from \"next/navigation\"\n\nconst SignupSchema = z.object({\n    name: z.string().min(2, \"El nombre debe tener al menos 2 caracteres\"),\n    email: z.string().email(\"Correo electrónico inválido\"),\n    password: z.string().min(5, \"La contraseña debe tener al menos 5 caracteres\"),\n    confirmPassword: z.string(),\n    role: z.enum([\"user\", \"professor\"]).default(\"user\"),\n}).refine((data) => data.password === data.confirmPassword, {\n    message: \"Las contraseñas no coinciden\",\n    path: [\"confirmPassword\"],\n})\n\nexport async function registerUser(prevState: any, formData: FormData) {\n    const validatedFields = SignupSchema.safeParse({\n        name: formData.get(\"name\"),\n        email: formData.get(\"email\"),\n        password: formData.get(\"password\"),\n        confirmPassword: formData.get(\"confirmPassword\"),\n        role: formData.get(\"role\"),\n    })\n\n    if (!validatedFields.success) {\n        return {\n            errors: validatedFields.error.flatten().fieldErrors,\n            message: \"Error en los datos del formulario\",\n        }\n    }\n\n    const { name, email, password, role } = validatedFields.data\n\n    try {\n        const existingUser = await prisma.user.findUnique({\n            where: { email },\n        })\n\n        if (existingUser) {\n            return {\n                message: \"El correo electrónico ya está registrado\",\n            }\n        }\n\n        const hashedPassword = await bcrypt.hash(password, 10)\n\n        await prisma.user.create({\n            data: {\n                name,\n                email,\n                password: hashedPassword,\n                role: role,\n            },\n        })\n\n    } catch (error) {\n        console.error(\"Registration error:\", error)\n        return {\n            message: \"Error al crear la cuenta. Por favor intenta de nuevo.\",\n        }\n    }\n\n    redirect(\"/auth/login\")\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AAAA;;;;;;;AAEA,MAAM,eAAe,6MAAC,CAAC,MAAM,CAAC;IAC1B,MAAM,6MAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IACxB,OAAO,6MAAC,CAAC,MAAM,GAAG,KAAK,CAAC;IACxB,UAAU,6MAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IAC5B,iBAAiB,6MAAC,CAAC,MAAM;IACzB,MAAM,6MAAC,CAAC,IAAI,CAAC;QAAC;QAAQ;KAAY,EAAE,OAAO,CAAC;AAChD,GAAG,MAAM,CAAC,CAAC,OAAS,KAAK,QAAQ,KAAK,KAAK,eAAe,EAAE;IACxD,SAAS;IACT,MAAM;QAAC;KAAkB;AAC7B;AAEO,eAAe,aAAa,SAAc,EAAE,QAAkB;IACjE,MAAM,kBAAkB,aAAa,SAAS,CAAC;QAC3C,MAAM,SAAS,GAAG,CAAC;QACnB,OAAO,SAAS,GAAG,CAAC;QACpB,UAAU,SAAS,GAAG,CAAC;QACvB,iBAAiB,SAAS,GAAG,CAAC;QAC9B,MAAM,SAAS,GAAG,CAAC;IACvB;IAEA,IAAI,CAAC,gBAAgB,OAAO,EAAE;QAC1B,OAAO;YACH,QAAQ,gBAAgB,KAAK,CAAC,OAAO,GAAG,WAAW;YACnD,SAAS;QACb;IACJ;IAEA,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,QAAQ,EAAE,IAAI,EAAE,GAAG,gBAAgB,IAAI;IAE5D,IAAI;QACA,MAAM,eAAe,MAAM,6JAAM,CAAC,IAAI,CAAC,UAAU,CAAC;YAC9C,OAAO;gBAAE;YAAM;QACnB;QAEA,IAAI,cAAc;YACd,OAAO;gBACH,SAAS;YACb;QACJ;QAEA,MAAM,iBAAiB,MAAM,kLAAM,CAAC,IAAI,CAAC,UAAU;QAEnD,MAAM,6JAAM,CAAC,IAAI,CAAC,MAAM,CAAC;YACrB,MAAM;gBACF;gBACA;gBACA,UAAU;gBACV,MAAM;YACV;QACJ;IAEJ,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,uBAAuB;QACrC,OAAO;YACH,SAAS;QACb;IACJ;IAEA,IAAA,uOAAQ,EAAC;AACb;;;IAhDsB;;AAAA,qRAAA"}},
    {"offset": {"line": 87, "column": 0}, "map": {"version":3,"sources":["file:///home/finvia/Documentos/GitHub/academiamx/.next-internal/server/app/auth/signup/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {handleSignOut as '007d61cc7bd6e272accc74a9e7759a48bd4a07d567'} from 'ACTIONS_MODULE0'\nexport {handleSignOut as '007d61cc7bd6e272accc74a9e7759a48bd4a07d567'} from 'ACTIONS_MODULE0'\nexport {registerUser as '60fea5f5273463abdef6f1dec542871e815b5586e0'} from 'ACTIONS_MODULE1'\n"],"names":[],"mappings":";AAAA;AAEA"}}]
}